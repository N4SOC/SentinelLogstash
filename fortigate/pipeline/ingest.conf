input {
  tcp {
    port => 514
    type => syslog
    codec => cef {
      delimiter => "\n"
    }
  }
}
filter {
  if ("server-rst" in [name] or "client-rst" in [name] or "traffic close" in [name] or "traffic timeout" in [name]) {
    drop {
    }
  }

  if ([applicationProtocol]=="DNS" or [applicationProtocol]=="NTP" or [applicationProtocol]=="PING" or [applicationProtocol]=="SYSLOG" or [applicationProtocol]=="SNMP") {
    drop {
    }
  }

  if ([destinationAddress]=="10.200.105.22" and [destinationPort]=="10000") {
    drop {
    }
  }
  geoip {

    source => "sourceAddress"
    target => "geoip"
    add_field => [ "[geoip][coordinates]", "%{[geoip][longitude]}" ]
    add_field => [ "[geoip][coordinates]", "%{[geoip][latitude]}"  ]
    add_field => [ "[geoip][country_name]", "%{[geoip][country_name]}"  ]
    add_field => [ "[geoip][city_name]", "%{[geoip][city_name]}"  ]
  }
  mutate {
    convert => [ "[geoip][coordinates]", "float" ]
  }

}


output {
  pipeline {
    send_to => ["sentinel"]
  }
}

